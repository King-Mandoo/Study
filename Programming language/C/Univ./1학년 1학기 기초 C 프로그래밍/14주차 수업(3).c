2022. 06. 02.

π΅ λ©”λ¨λ¦¬ ν• λ‹Ή ν•¨μ
   
π  κΌ­ κΈ°μ–µν•΄μ•Ό ν•  ν¬μΈν„°μ μ£Όμ” λ‚΄μ©

   * μ»΄ν“¨ν„°μ λ¨λ“  λ©”λ¨λ¦¬μ—λ” μ£Όμ†κ°€ μ§€μ •λμ–΄ μλ‹¤.
   
   * int aa[3]κ³Ό κ°™μ΄ λ°°μ—΄μ„ μ„ μ–Έν•λ©΄ λ°°μ—΄ aaλ” λ³€μκ°€ μ•„λ‹ λ©”λ¨λ¦¬μ μ£Όμ†κ°’ κ·Έ μμ²΄λ¥Ό μλ―Έν•λ‹¤.
     κ·Έλ¦¬κ³  μ΄λ¥Ό ν¬μΈν„° μƒμλΌκ³ λ„ ν•λ‹¤.
   
   * ν¬μΈν„° λ³€μλ” μ£Όμ†λ¥Ό λ‹΄λ” κ·Έλ¦‡(λ³€μ)μ΄κ³ , ν¬μΈν„° λ³€μλ¥Ό μ„ μ–Έν•  λ•λ” int* p λλ” char *pμ™€ κ°™μ΄
     *(asterisk)λ¥Ό λ¶™μ—¬μ„ μ„ μ–Έν•λ‹¤.
     
   * ν¬μΈν„° λ³€μμ—λ” μ£Όμ†λ§ λ€μ…ν•΄μ•Ό ν•λ”λ° μ΄λ• λ³€μ μ•μ— &λ¥Ό λ¶™μΈλ‹¤.
   
 
  #include <stdio.h>

int main(void)
{
	int aa[3];
	int* p;
	int hap = 0;

	for (int i = 0; i < 3; i++)
	{
		printf("%d λ²μ§Έ μ«μ : ", i + 1);
		scanf("%d", &aa[i]);
	}

	p = aa;

	for (int i = 0; i < 3; i++)
	{
		hap = hap + *(p + i);
	}
	printf("ν•©κ³„ : %d", hap);


	return 0;
}


π  λ™μ  λ©”λ¨λ¦¬ ν™•λ³΄: malloc()   --> memory allocation

    --> λ©”λ¨λ¦¬λ¥Ό λ―Έλ¦¬ μ΅μ•„λ‘μ§€ μ•κ³  ν•„μ”ν•  λ•λ§λ‹¤ λ©”λ¨λ¦¬λ¥Ό ν™•λ³µν•λ” κ²ƒμ„ 
        'λ™μ  λ©”λ¨λ¦¬ ν™•λ³΄ (dynamic memory allocation)'λΌκ³  ν•λ©°, μ΄λ• μ‚¬μ©ν•λ” ν•¨μλ” malloc()μ΄λ‹¤.
                         
                         * allocation λ» : λ°°κΈ‰, λ°°λ‹Ή
                         
   π”· λ™μ  λ©”λ¨λ¦¬ ν™•λ³΄μ κ°λ…


#include <stdio.h>    

int main(void)
{
	int aa[10000];
	int* p;
	int hap = 0;
	int cnt;

	printf("μ…λ ¥ν•  κ°μλ”? ");
	scanf("%d", &cnt);

	for (int i = 0; i < cnt; i++)
	{
		printf("%2d λ²μ§Έ μ«μ : ", i + 1);
		scanf("%d", &aa[i]);
	}
                                              
	p = aa;

	for (int i = 0; i < cnt; i++)
		hap = hap + *(p + i);

	printf("μ…λ ¥ μ«μμ ν•© ==> %d", hap);

	return 0;
}                         

   π”Ίπ”Ί μ΄ μ½”λ“μ—λ” λ‹¤μκ³Ό κ°™μ€ λ¬Έμ κ°€ μμ„ μ μλ‹¤.
      
       1. λ§μ•½ 10000κ°κ°€ λ„λ” μ«μλ¥Ό λ”ν•κ³  μ‹¶μ„ λ•λ” μ΄ ν”„λ΅κ·Έλ¨μΌλ΅ κ³„μ‚°ν•  μ μ—†λ‹¤.
       
       2. λ” ν° λ¬Έμ λ” λ©”λ¨λ¦¬μ λ‚­λΉ„μ΄λ‹¤. μ΄ μμ—μ„λ” μ „μ²΄ λ°°μ—΄ μ¤‘ κ²¨μ° 3κ°λ§ μ‚¬μ©ν•κ³  μΆ…λ£ν–μΌλ―€λ΅
          μ‚¬μ©λμ§€ μ•μ€ λ‚λ¨Έμ§€ 9997κ°μ λ©”λ¨λ¦¬λ” λ‚­λΉ„λ κ²ƒμ΄λ‹¤. 
          μ§μ„ μ®κΈ°λ” λ° 10000λ…μ΄ κ°€μ„ λ‹¬λ‘ 3λ…λ§ μ§μ„ λ“¤κ³  λ‚λ¨Έμ§€ 9997λ…μ€ λΉμ†μΈ κ²©μ΄λ‹¤.

   μ΄μ™€ κ°™μ€ λ©”λ¨λ¦¬ λ‚­λΉ„λ¥Ό λ§‰μΌλ ¤λ©΄ ν•„μ”ν• λ§νΌμ λ©”λ¨λ¦¬λ¥Ό ν™•λ³΄ν•΄μ„ μ‚¬μ©ν•΄μ•Ό ν•λ‹¤.
   
   -----------
   
   λ¨Όμ € λ”ν•λ ¤λ” μ«μκ°€ λ‡ κ°μΈμ§€ μ‚¬μ©μμ—κ² λ¬Όμ–΄λ³΄κ³  malloc() ν•¨μλ¥Ό μ‚¬μ©ν•μ—¬ λ©”λ¨λ¦¬λ¥Ό ν™•λ³΄ν•λ‹¤.
   λ§μ•½ μ‚¬μ©μκ°€ μ«μ 3κ°λ¥Ό μ…λ ¥ν•κ³ μ ν•λ‹¤λ©΄ λ©”λ¨λ¦¬ μ„Έ μΉΈμ„ ν™•λ³΄ν•κ³  ν™•λ³΄ν• μ£Όμ†λ¥Ό ν¬μΈν„° λ³€μμ— λ„£λ”λ‹¤.
   
   ν¬μΈν„° λ³€μ = (ν¬μΈν„° λ³€μμ λ°μ΄ν„°ν•*) malloc(ν¬μΈν„° λ³€μμ λ°μ΄ν„°ν• ν¬κΈ° X ν•„μ”ν• ν¬κΈ°)
            p = (int*) malloc(sizeof(int) * 3);

#include <stdio.h>
#include <stdlib.h>  // λλ” malloc.h

int main(void)
{
	int* p;
	int hap = 0;
	int count;

	printf("λ‡ κ°μ μ«μ μ…λ ¥?? ==> ");
	scanf("%d", &count);

	p = (int*)malloc(sizeof(int) * count);

	for (int i = 0; i < count; i++)
	{
		printf("%d λ²μ¨° μ«μ μ…λ ¥: ", i + 1);
		scanf("%d", &p[i]);   // p+i
		hap = hap + *(p + i);
	}

	printf("ν•©: %d", hap);

	free(p);

	return 0;
}

--------------------------

#include <stdio.h>
#include <stdlib.h>  // λλ” malloc.h

int main(void)
{
	char* pc = NULL;
	int i = 0;

	pc = (char*)malloc(100 * sizeof(char));  // 100κ°μ λ¬Έμν•μ΄ λ“¤μ–΄κ° μ μλ” κ³µκ°„μ„ μƒμ„± (λ°°μ—΄κ³Ό λΉ„μ·ν• λλ‚?)

	if (pc == NULL)
		free(pc);

	for (i = 0; i < 26; i++)
		*(pc + i) = 'a' + i;

	*(pc + i) = 0;

	printf("%s\n", pc);
	free(pc);   // λ©”λ¨λ¦¬λ¥Ό ν•΄μ ν•΄μ¤€λ‹¤. μ„ νƒ μ•„λ‹ ν•„μ.

	return 0;
}

--------------------------

#include <stdio.h>
#include <stdlib.h>  // λλ” malloc.h

int main(void)
{
	int* pi = NULL;

	pi = (int*)malloc(5 * sizeof(int));   // ππ κ·Έλƒ¥ malloc(λ‚΄κ°€ ν•„μ”ν• κ³µκ°„μ ν¬κΈ°) λΌκ³  μƒκ°ν•λ©΄ λ κ±°κ°™λ‹¤.
             
             /*
                μ‚¬μ‹¤
                pi = (int*)malloc(20); μ΄λ ‡κ² μ¨μ¤λ„ μƒκ΄€μ€ μ—†λ‹¤.
                ν•μ§€λ§ μ΄λ³΄μ μ…μ¥μ—μ„λ” λ‚μ μλ„λ¥Ό λ…ν™•ν ν‘ν„ν•΄μ£Όλ” κ²ƒμ΄ μ¤‘μ”ν•λ‹¤.
                λ”°λΌμ„  pi = (int*)malloc(5 * sizeof(int));  μ΄λ ‡κ² μ½”λ“λ¥΄ μ§λ” κ²ƒμ΄ λ” λ°”λμ§ν•λ‹¤.
             */
             
	if (pi == NULL)
		free(pi);

	pi[0] = 1;
	pi[1] = 2;
	pi[2] = 3;
	pi[3] = 4;
	pi[4] = 5;

	for (int i = 0; i < 5; i++)
		printf("%d\n", *(p + i));

	free(pi);

	return 0;
}
     β… 	Q. pi = (int*)malloc(5 * sizeof(int)); μ΄ λ¶€λ¶„μ—μ„ (int*)κ°€ λ»ν•λ” κ±΄ λ¬΄μ—‡μ΄μ§€..??
     
          A.  pi = malloc(5 * sizeof(int));  μ΄μ™€ κ°™μ΄ λ©”λ¨λ¦¬ ν• λ‹Ήμ„ ν•κ² λλ©΄
              μΆμΈ΅ μ°μΈ΅μ μλ£ν•μ΄ μ„λ΅ μΌμΉν•μ§€ μ•λ”λ‹¤.
              μ¦‰, μΆμΈ΅μ— μλ” ν¬μΈν„° piλ” int* μλ£ν•μ΄κ³  malloc ν•¨μλ” void* μ΄κΈ° λ•λ¬Έμ— μ„λ΅ λ‹¤λ¥Έ μλ£ν•μ΄λ‹¤.
              λ”°λΌμ„ λ‘ μλ£ν•μ„ μΌμΉμ‹μΌμ•Ό ν•λ‹¤.
              λ”°λΌμ„ pi = (int*)malloc(5 * sizeof(int)); μ΄λ ‡κ²
              λ…μ‹μ  ν• λ³€ν™μ„ μ‚¬μ©ν•λ” κ²ƒμ΄ μΆ‹λ‹¤.
              
        ππ  malloc() ν•¨μ μ•μ— μ“΄ (int*)λ¥Ό 'μΊμ¤νΈ μ—°μ‚°μ'λΌκ³  ν•λ‹¤.   //  μΊμ¤νΈ μ—°μ‚°μλ” μ–΄λ– ν• μλ£ν•μ„ λ‹¤λ¥Έ μλ£ν•μΌλ΅ λ³€ν™ν•λ” μ—°μ‚°μμ…λ‹λ‹¤.
              malloc(sizeof(int) * 3)μ„ μν–‰ν• κ²°κ³Όλ΅ 12λ°”μ΄νΈλ¥Ό ν™•λ³΄ν•λ”λ° μ•„μ§μ€ μ΄λ¥Ό μ–΄λ–¤ ν•νƒλ΅ λ‚λ μ•Ό ν• μ§€ λ¨λ¥Έλ‹¤.
              μ΄λ• (int*)λ¥Ό λ¶™μ—¬ λ©”λ¨λ¦¬κ°€ μ •μν•μΌλ΅ ν• λ‹Ήλμ—μμ„ μ•λ ¤μ¤μΌλ΅μ¨ 12λ°”μ΄νΈλ¥Ό 4λ°”μ΄νΈμ”© 3κ°λ΅ μλΌμ„ μ‚¬μ©ν•κ² ν•λ‹¤.
              λ§μ•½ (char*)malloc(12)λΌλ©΄ λ¬Έμν• ν¬κΈ°μΈ 1λ°”μ΄νΈμ”© 12κ°λ΅ μλΌμ„ μ‚¬μ©ν•λ‹¤.
                  
                     
                     
              β… Q. μ™ malloc ν•¨μλ” void* λ°ν™ν•μ„ μ‚¬μ©ν• κΉ??
                  
                  A. malloc ν•¨μλ” κ°λ°μκ°€ ν•„μ”ν• λ©”λ¨λ¦¬μ μ΄ ν¬κΈ°λ¥Ό λ°›μ•„μ„ ν•΄λ‹Ή ν¬κΈ°λ΅ λ©”λ¨λ¦¬λ¥Ό ν• λ‹Ήν•λ” ν•¨μμ΄μ§€
                     ν•΄λ‹Ή λ©”λ¨λ¦¬λ¥Ό μ–΄λ–¤ λ‹¨μ„μ™€ κµ¬μ„±μΌλ΅ μ‚¬μ©ν•  κ²ƒμΈμ§€λ” κ°λ°μκ°€ κ²°μ •ν•λ” κ²ƒμ΄λ‹¤.
                     λ”°λΌμ„ malloc ν•¨μλ” μμ‹ μ΄ ν• λ‹Ήν• λ©”λ¨λ¦¬κ°€ μ–΄λ–¤ λ‹¨μ„ λλ” μ–΄λ–¤ κµ¬μ„±μΌλ΅ μ‚¬μ©λ μ§€
                     μμƒν•  μ μ—†κΈ° λ•λ¬Έμ— λ€μƒμ ν¬κΈ°κ°€ μ •ν•΄μ Έ μμ§€ μ•λ‹¤λ” λ»μ void*λ΅ μ£Όμ†λ¥Ό λ°ν™ν•λ” κ²ƒμ΄λ‹¤.
                     
                                                         μ¶μ²: https://m.blog.naver.com/PostView.naver?isHttpsRedirect=true&blogId=tipsware&logNo=221325651422
                                                         
     λ„μ›€ λλ” μ •λ³΄: https://codingdog.tistory.com/entry/c%EC%96%B8%EC%96%B4-malloc-%ED%95%A8%EC%88%98-%EB%8F%99%EC%A0%81-%ED%95%A0%EB%8B%B9-%EA%B0%84%EB%8B%A8%ED%95%98%EA%B2%8C-%EC%9D%B4%ED%95%B4%ED%95%B4-%EB%B4%85%EC%8B%9C%EB%8B%A4                                


                                                         
       π”· κ·Έ μ™Έ λ©”λ¨λ¦¬ κ΄€λ ¨ ν•¨μμ ν™μ©    
       
 β—β—β— calloc(ν¬μΈν„° λ³€μμ λ°μ΄ν„°ν• ν¬κΈ°, ν•„μ”ν• ν¬κΈ°)  -->  contiguous allocation    *contiguous λ»: μΈμ ‘ν•, μ ‘μ΄‰ν•λ”
                                                         
#include <stdio.h>
#include <stdlib.h> 

int main(void)
{
	int* p, * s;
	
	p = (int*)malloc(sizeof(int) * 3);
	s = (int*)calloc(sizeof(int), 3);    <-- calloc() ν•¨μμ μ‚¬μ©μ€ μΆ€ λ‹¤λ¥΄λ‹¤.

	for (int i = 0; i < 3; i++)
		printf("malloc() ν•¨μμ μ΄κΈ°κ°’: %d\n", *(p + i));

	printf("\n");

	for (int i = 0; i < 3; i++)
		printf("calloc() ν•¨μμ μ΄κΈ°κ°’: %d\n", *(s + i));

	return 0;
}

μ‹¤ν–‰κ²°κ³Ό: 
          malloc() ν•¨μμ μ΄κΈ°κ°’: -842150451
          malloc() ν•¨μμ μ΄κΈ°κ°’: -842150451
          malloc() ν•¨μμ μ΄κΈ°κ°’: -842150451

          calloc() ν•¨μμ μ΄κΈ°κ°’: 0
          calloc() ν•¨μμ μ΄κΈ°κ°’: 0
          calloc() ν•¨μμ μ΄κΈ°κ°’: 0
                                                         
                                                         
                                                         
 β—β—β— (ν¬μΈν„° λ³€μμ λ°μ΄ν„°ν•*) realloc(κΈ°λ³Έ ν¬μΈν„°, ν¬μΈν„° λ³€μμ λ°μ΄ν„°ν• ν¬κΈ° x ν•„μ”ν• ν¬κΈ°);   -->  re-allocation                                                  
                                                         
          --> realloc() ν•¨μλ” μ΄λ―Έ ν• λ‹Ήν• κ³µκ°„μ ν¬κΈ°λ¥Ό λ°”κΏ€ λ• μ‚¬μ©ν•λ‹¤.
                                                         
                                                         
 #include <stdio.h>
#include <stdlib.h> 

int main(void)
{
	int* p;
	int hap = 0;
	int count = 0;
	int data;

	p = (int*)malloc(sizeof(int) * 1);
	printf("1 λ²μ§Έ μ«μ : ");
	scanf("%d", p);
	count++;

	for (int i = 2;; i++)
	{
		printf("%d λ²μ§Έ μ«μ : ", i);
		scanf("%d", &data);

		if (data != 0)
			p = (int*)realloc(p, sizeof(int) * i);
		else
			break;

		p[i - 1] = data;
		count++;
	}

	for (int i = 0; i < count; i++)
		hap = hap + *(p + i);

	printf("%d", hap);

	free(p);

	return 0;
}                                                        
                                                         
                                                         
